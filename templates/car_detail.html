{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{{ car.brand }} {{ car.model }} - Carify</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #000;
            color: #fff;
        }
        .text-accent { color: #FF0000; }
        .btn-cta { background-color: #FF0000; color: #fff; transition: transform 0.2s; }
        .btn-cta:hover { transform: scale(1.05); }
        .card:hover { transform: translateY(-7px); box-shadow: 0 10px 20px rgba(0,0,0,0.5); transition: transform 0.3s; }
        .feature-badge { background: #FF0000; color: #fff; font-size: 0.85rem; margin-right: 0.3rem; margin-bottom: 0.3rem; padding: 0.3rem 0.6rem; border-radius: 0.3rem; display: inline-block; }
        .review-card { background-color: #1a1a1a; padding: 1rem; border-radius: 0.5rem; margin-bottom: 1rem; }
        .gallery img { max-height: 300px; object-fit: cover; }
    </style>
</head>
<body>

<!-- Navbar -->
{% include "partials/navbar.html" %}

<!-- Hero / Main Image -->
<section class="text-center position-relative">
    <img src="{{ car.main_image.url }}" class="img-fluid w-100" style="max-height: 600px; object-fit: cover;" alt="{{ car.brand }} {{ car.model }}">
    <div class="position-absolute top-50 start-50 translate-middle text-white">
        <h1 class="fw-bold display-4">{{ car.brand }} {{ car.model }}</h1>
        <p class="lead">Drive Your Dreams - Imported from Korea</p>
        <a href="{% url "create-order" product_type="car" product_id=car.pk %}" class="btn btn-cta btn-lg me-2">Buy Now</a>
        <a href="#order-parts" class="btn btn-outline-light btn-lg">Order Parts</a>
    </div>
</section>

<!-- Car Details -->
<section class="container py-5">
    <div class="row g-4">
        <!-- Gallery -->
        <div class="col-lg-6">
            <div class="gallery d-flex flex-wrap gap-2">
                {% for img in car.images.all %}
                    <img src="{{ img.image.url }}" class="img-fluid" alt="Car image {{ forloop.counter }}">
                {% endfor %}
            </div>
        </div>

        <!-- Info -->
        <div class="col-lg-6">
            <h2 class="fw-bold text-accent">{{ car.brand }} {{ car.model }} ({{ car.year }})</h2>
            <h3 class="text-white mb-3">${{ car.price }} {% if car.is_negotiable %}<small class="text-muted">(Negotiable)</small>{% endif %}</h3>
            
            <p><strong>Condition:</strong> {{ car.get_condition_display }}</p>
            <p><strong>Fuel Type:</strong> {{ car.get_fuel_type_display }}</p>
            <p><strong>Transmission:</strong> {{ car.get_transmission_display }}</p>
            <p><strong>Engine Volume:</strong> {{ car.engine_volume }} L</p>
            <p><strong>Mileage:</strong> {{ car.mileage }} km</p>

            <h5 class="mt-3">Key Features:</h5>
            <div>
                {% if car.features.exists %}
                    {% for feature in car.features.all %}
                        <span class="feature-badge">{{ feature.name }}</span>
                    {% endfor %}
                {% else %}
                    <p class="text-muted fst-italic">No features listed.</p>
                {% endif %}
            </div>

            <p class="mt-3">{{ car.description|default:"No description available." }}</p>
        </div>
    </div>
</section>

<!-- Reviews -->
<section class="container py-5">
    <h2 class="fw-bold text-accent mb-4">Customer Reviews</h2>
    {% if car.reviews.exists %}
        {% for review in car.reviews.all %}
            <div class="review-card">
                <p>"{{ review.comment }}"</p>
                <p class="fw-bold mb-0">Rating: {{ review.rating }}/5 â€” {{ review.user.username }}</p>
            </div>
        {% endfor %}
    {% else %}
        <p class="text-muted fst-italic">No reviews yet.</p>
    {% endif %}
</section>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
